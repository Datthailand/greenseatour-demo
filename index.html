Copy
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>GreenSeaTour - Bảng Báo Giá</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- FontAwesome để hiện icon món ăn -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --main-bg: #034C36;
      --dark-bg: #003332;
      --accent: #FF812B;
      --accent2: #E3B8B8;
      --accent3: #E3BB8B;
      --accent4: #BC430D;
      --text-light: #F2E0DF;
      --text-gray: #BDCDCF;
      --shadow: 0 2px 18px 0 rgba(3,76,54,0.12);
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--dark-bg);
      color: var(--text-light);
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 30px auto;
      background: var(--main-bg);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 32px 32px 24px 32px;
    }
    .title {
      text-align: center;
      font-size: 2.2rem;
      font-weight: bold;
      color: #30e18e;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }
    .subtitle {
      text-align: center;
      font-size: 1.1rem;
      color: var(--text-gray);
      margin-bottom: 22px;
    }
    .actions {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }
    .actions button {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 14px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
      box-shadow: 0 2px 8px #0002;
    }
    .actions button:nth-child(2) { background: var(--accent2); color: var(--dark-bg);}
    .actions button:nth-child(3) { background: var(--accent3); color: var(--dark-bg);}
    .actions button:nth-child(4) { background: var(--accent4); }

    table {
      width: 100%;
      border-collapse: collapse;
      background: var(--dark-bg);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 18px;
      box-shadow: 0 1px 8px #0001;
    }
    thead {
      background: var(--main-bg);
    }
    th, td {
      padding: 10px 10px;
      text-align: center;
      border-bottom: 1px solid #034c36a0;
      font-size: 1rem;
    }
    th {
      color: var(--accent);
      font-weight: bold;
      background: #003332e0;
    }
    td {
      color: var(--text-gray);
      background: #003332d0;
    }
    tr:last-child td { border-bottom: none; }

    .add-btn {
      background: var(--accent2);
      color: var(--dark-bg);
      border-radius: 8px;
      border: none;
      padding: 5px 12px;
      margin-left: 6px;
      font-weight: 500;
      cursor: pointer;
      font-size: 0.97rem;
      transition: background 0.2s;
    }

    .summary-row {
      background: var(--main-bg) !important;
      color: var(--accent) !important;
      font-weight: bold;
    }

    .usd-row { color: #30e18e; font-size: 1.1em; }
    .usd-row th, .usd-row td { background: #034C36; }

    .section-title {
      color: var(--accent);
      font-size: 1.1rem;
      margin: 24px 0 10px 0;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .settings-panel {
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .card {
      background: #003332;
      border-radius: 10px;
      padding: 16px;
      min-width: 260px;
      flex: 1 0 260px;
      box-shadow: 0 1px 8px #0001;
      color: var(--text-gray);
    }
    .card label {
      display: block;
      font-size: 0.98em;
      margin-bottom: 4px;
      color: var(--accent3);
    }
    .card input, .card select {
      width: 100%;
      padding: 6px 8px;
      border-radius: 5px;
      border: 1px solid #bdcdcf55;
      margin-bottom: 10px;
      margin-top: 2px;
      background: #00221d;
      color: var(--text-light);
      font-size: 1em;
    }
    .card .chip {
      background: var(--accent);
      color: #fff;
      border-radius: 8px;
      padding: 2px 10px;
      margin-right: 7px;
      display: inline-block;
      font-size: 0.96em;
    }
    .export-btn {
      background: #30e18e;
      color: #003332;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      padding: 12px 32px;
      font-size: 1.05em;
      margin-top: 18px;
      float: right;
      cursor: pointer;
      transition: 0.2s;
    }
    .export-btn:hover { background: #23a86d; }
    @media (max-width: 900px) {
      .settings-panel { flex-direction: column; }
      .container { padding: 10px; }
    }

    /* Popup */
    .popup-outer {
      position: fixed; z-index: 9999;
      left: 0; top: 0; right: 0; bottom: 0;
      background: #0008; display: flex; align-items: center; justify-content: center;
    }
    .popup-inner {
      background: #fff;
      color: #003332;
      border-radius: 14px;
      padding: 32px 30px;
      min-width: 320px;
      max-width: 95vw;
      box-shadow: 0 6px 40px #0004;
      max-height: 80vh;
      overflow-y: auto;
      text-align: left;
    }
    .popup-inner h3 {
      margin-top: 0; color: var(--accent);
      font-size: 1.3em;
    }
    .popup-inner ul {
      list-style: none;
      padding: 0;
      margin: 0 0 16px 0;
    }
    .popup-inner li {
      padding: 8px 0;
      border-bottom: 1px solid #e3bb8b44;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.05em;
    }
    .popup-inner li:last-child { border-bottom: none; }
    .popup-inner button {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 6px 18px;
      font-size: 1em;
      margin-top: 8px;
      cursor: pointer;
      float: right;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">Green<span style="color:#30e18e">Sea</span>Tour</div>
    <div class="subtitle">Bảng Báo Giá: "Hồ Chí Minh - Mũi Né 3 ngày 2 đêm"</div>
    <div class="actions">
      <button>Tiếp Tour Mới</button>
      <button>Nhập từ Excel</button>
      <button>Tải Tour LÊSON</button>
      <button>Lưu Tour LÊSON</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>DANH MỤC</th>
          <th>8 KHÁCH</th>
          <th>10 KHÁCH</th>
          <th>15 KHÁCH</th>
          <th>20 KHÁCH</th>
          <th>25 KHÁCH</th>
          <th>30 KHÁCH</th>
          <th>35 KHÁCH</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align:left;"><b>Ngày 1</b></td>
          <td colspan="7"></td>
          <td><button class="add-btn" data-type="other">+ Thêm hạng mục</button></td>
        </tr>
        <tr>
          <td style="text-align:left;">xe HCM - Mũi Né 3 ngày</td>
          <td>1,312,500</td><td>1,050,000</td><td>766,667</td>
          <td>650,000</td><td>520,000</td><td>433,333</td><td>371,429</td>
          <td></td>
        </tr>
        <tr>
          <td style="text-align:left;">hdv</td>
          <td>281,250</td><td>225,000</td><td>150,000</td>
          <td>112,500</td><td>90,000</td><td>84,848</td><td>75,000</td>
          <td></td>
        </tr>
        <tr>
          <td style="text-align:left;">nước uống</td>
          <td>15,000</td><td>15,000</td><td>15,000</td>
          <td>15,000</td><td>15,000</td><td>15,000</td><td>15,000</td>
          <td></td>
        </tr>
        <tr>
          <td style="text-align:left;"><b>Bữa ăn</b></td>
          <td colspan="7"></td>
          <td><button class="add-btn" data-type="meal">+ Thêm hạng mục</button></td>
        </tr>
        <tr>
          <td style="text-align:left;">ăn trưa Cao Phát</td>
          <td>150,000</td><td>150,000</td><td>150,000</td>
          <td>150,000</td><td>150,000</td><td>150,000</td><td>150,000</td>
          <td></td>
        </tr>
        <!-- ... Thêm các dòng khác tùy ý ... -->
        <tr class="summary-row">
          <td style="text-align:left;">Tổng (VND)</td>
          <td>3,598,750</td><td>3,280,000</td><td>3,039,344</td>
          <td>2,855,750</td><td>2,685,000</td><td>2,577,196</td><td>2,491,144</td>
          <td></td>
        </tr>
        <tr class="usd-row">
          <td style="text-align:left;">Báo giá (USD)</td>
          <td>$166</td><td>$149</td><td>$138</td>
          <td>$127</td><td>$120</td><td>$116</td><td>$113</td>
          <td></td>
        </tr>
      </tbody>
    </table>
    
    <button class="add-btn" style="display:block;margin:0 auto 18px auto;">+ Thêm Ngày Mới</button>
    
    <div class="section-title">Giá Tour Theo Số Lượng Khách (03/09-30/11/2025)</div>
    <table>
      <thead>
        <tr>
          <th>THỜI GIAN</th>
          <th>8-9 KHÁCH</th>
          <th>10-14 KHÁCH</th>
          <th>15-19 KHÁCH</th>
          <th>20-24 KHÁCH</th>
          <th>25-29 KHÁCH</th>
          <th>30-34 KHÁCH</th>
          <th>NGỦ ĐƠN</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>03/09-30/11/2025</td>
          <td>$166</td>
          <td>$149</td>
          <td>$138</td>
          <td>$127</td>
          <td>$120</td>
          <td>$116</td>
          <td>+ $25</td>
        </tr>
      </tbody>
    </table>
    <div style="margin:10px 0 24px 0; color: var(--accent2);">
      <b>Ghi chú:</b> Không áp dụng đoàn lẻ/không bao gồm lễ tết. <br>
      <span style="color:var(--accent3);">Giá báo chưa bao gồm VAT. Số lượng khách lẻ: +100k/người, Ngủ đơn: +100k</span>
    </div>
    
    <div class="settings-panel">
      <div class="card">
        <label for="rate">Tỷ giá USD/VND</label>
        <input type="number" id="rate" value="25500">
        <label for="soluong">Số khách tùy chỉnh</label>
        <input type="number" id="soluong" value="10">
      </div>
      <div class="card">
        <label>Cài đặt lợi nhuận</label>
        <div><span class="chip">8-9 khách</span> <input type="number" value="25"></div>
        <div><span class="chip">10-14 khách</span> <input type="number" value="20"></div>
        <div><span class="chip">15-19 khách</span> <input type="number" value="17"></div>
        <div><span class="chip">20-34 khách</span> <input type="number" value="15"></div>
      </div>
      <div class="card">
        <label>Chi phí phát sinh trưởng đoàn</label>
        <div>Phụ thu Ngủ đơn <b>(Thêm 1 TL)</b></div>
        <input type="text" value="Thêm">
        <div>Thêm Trưởng đoàn mới <b>(Thêm 1 TL)</b></div>
        <input type="text" value="Thêm">
        <div>Thêm 1 TL &amp; 1 Ngủ đơn</div>
        <input type="text" value="Thêm">
      </div>
    </div>
    
    <button class="export-btn">Xuất Excel</button>
    <div style="clear:both;"></div>
  </div>
  <!-- Script Google Sheets + Popup Bữa Ăn -->
  Copy
<script>
async function fetchMeals() {
  const url = "https://docs.google.com/spreadsheets/d/1RU3jggSUKWbi45HYU2UR3S3yBjdpdArK5obL6257lgY/gviz/tq?tqx=out:json&sheet=SuggestedItems";
  let response = await fetch(url);
  let text = await response.text();
  let json = JSON.parse(text.substr(47).slice(0, -2));
  let cols = json.table.cols.map(c => c.label.trim());
  let data = json.table.rows.map(row => {
      let obj = {};
      row.c.forEach((cell, i) => {
          obj[cols[i]] = cell ? cell.v : "";
      });
      return obj;
  });
  let meals = data.filter(row => (row.Type && row.Type.toLowerCase().includes("bữa ăn")) && row.Name);
  return meals;
}

<script>
async function fetchMeals() {
    // (Giữ nguyên như trước)
}

function addMealRowToTable(meal) {
    let table = document.querySelector('table tbody');
    if (!table) return;
    
    let insertIndex = -1;
    let rows = table.querySelectorAll('tr');
    
    for (let i = 0; i < rows.length; i++) {
        if (rows[i].querySelector('td') && rows[i].querySelector('td').innerText.trim() === "Bữa ăn") {
            insertIndex = i + 1;
            break;
        }
    }
    
    if (insertIndex === -1) return;
    
    let tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="text-align:left;">
        <i class="${meal.Icon}" style="color:#FF812B"></i> ${meal.Name}
      </td>
      <td colspan="7" style="color:#BC430D;font-weight:bold;text-align:right;">${meal.Price_VND.toLocaleString()} VND</td>
      <td style="text-align:center;"><button class="remove-btn">Xóa</button></td>
    `;
    
    if (rows[insertIndex]) {
        table.insertBefore(tr, rows[insertIndex]);
    } else {
        table.appendChild(tr);
    }
    
    // Cập nhật tổng giá
    updateTotal();
    
    // Thêm sự kiện xóa món ăn
    tr.querySelector('.remove-btn').onclick = function() {
        tr.remove();
        updateTotal();
    };
}

function updateTotal() {
    let total = 0;
    let rows = document.querySelectorAll('table tbody tr');
    rows.forEach(row => {
        let priceCell = row.querySelector('td:nth-child(2)');
        if (priceCell) {
            total += parseFloat(priceCell.innerText.replace(/,/g, '')) || 0;
        }
    });
    document.querySelector('.summary-row td:nth-child(2)').innerText = total.toLocaleString() + ' VND';
}

function showMealPopup(meals) {
    // (Giữ nguyên như trước)
}

document.addEventListener("DOMContentLoaded", function() {
    // (Giữ nguyên như trước)
});
</script>



</body>
</html>
